function comboBoxController(a,b,c,d){function e(a){return"string"==typeof a?{value:a,text:a}:a}function f(){for(var b=0;b<a.options.length;b++)if("other"===a.options[b].value)return!0;return!1}function g(){var b=k(a.comboModel),c=m(a.comboModel);a.isValid=!a.required||!b&&!c,a.comboForm.$setValidity("comboRequired",a.isValid)}function h(b){if(b=e(b),a.isOtherSelected=l(b),k(b))a.selected={value:""};else{a.isOtherSelected&&(a.otherText=b.text);var c=n(b);null===c?(a.selected=n({value:"other"}),a.otherText=b.text):a.selected=c}}function i(d){a.isOtherSelected=l(d),k(d)?j(null,null):a.isOtherSelected?(j("other",a.otherText),c(function(){b.find("input")[0].focus()})):j(d.value,d.text)}function j(b,c){(null===a.comboModel||void 0===a.comboModel)&&(a.comboModel={}),a.comboModel={value:b,text:c},g()}function k(a){var b=void 0===a||null===a||""===a.value||null===a.value;return b}function l(a){return!k(a)&&"string"==typeof a.value&&"other"===a.value.toLowerCase()}function m(a){return l(a)&&(void 0===a.text||null===a.text||""===a.text)}function n(b){var c=d("filter")(a.options,{value:b.value},!0);return c.length>0?c[0]:null}for(var o=0;o<a.options.length;o++)a.options[o]=e(a.options[o]);f()||a.options.push({value:"other",text:"Other"}),a.comboModel=e(a.comboModel),a.setModelFromInput=i,a.isOtherSelected=!1,a.otherText=null,a.isValid=!1,a.comboModel&&h(a.comboModel),a.$watch("comboModel",function(a,c){if(void 0!==a){var d=document.activeElement!=b.find("input")[0];d&&h(a),g()}}),a.$watch("required",function(a){g()})}angular.module("ngComboBox.controller",[]).controller("comboBoxController",["$scope","$element","$timeout","$filter",comboBoxController]),angular.module("ngComboBox.directive",[]).directive("comboBox",function(a){return{restrict:"E",scope:{options:"=",comboModel:"=",otherLabel:"@?",label:"@?",inputClass:"=",selectClass:"=",required:"=?",isValid:"=?",isOtherSelected:"=?",otherPlaceholder:"@?"},templateUrl:"combo-box.html",compile:function(a,b){b.otherLabel||(b.otherLabel="Other"),b.label||(b.label=""),b.otherPlaceholder||(b.otherPlaceholder="")},controller:"comboBoxController"}}),angular.module("ngComboBox",["ngComboBox.directive","ngComboBox.controller","templates-main"]),angular.module("templates-main",["combo-box.html"]),angular.module("combo-box.html",[]).run(["$templateCache",function(a){a.put("combo-box.html",'<ng-form name="comboForm">\n	<select name="comboSelect" \n			ng-model="selected" \n			ng-class="selectClass" \n			ng-change="setModelFromInput(selected)" \n			ng-options="option.text for option in options track by option.value" \n			ng-required="required">\n		<option value="">{{label}}</option>\n	</select>\n	<br />\n	<input 	name="comboText" \n			type="text" \n			placeholder="{{otherPlaceholder}}" \n			ng-model="otherText" \n			ng-class="inputClass" \n			ng-change="setModelFromInput(selected)" \n			ng-show="isOtherSelected" \n			ng-required="required && isOtherSelected" />\n</ng-form>\n\n')}]);